/***
 *              _____                    _____                    _____                    _____             _____                    _____                    _____                    _____             _____                        
 *             /\    \                  /\    \                  /\    \                  /\    \           /\    \                  /\    \                  /\    \                  /\    \           /\    \                       
 *            /::\    \                /::\____\                /::\    \                /::\    \         /::\    \                /::\    \                /::\    \                /::\    \         /::\    \                      
 *           /::::\    \              /::::|   |               /::::\    \              /::::\    \        \:::\    \              /::::\    \              /::::\    \              /::::\    \        \:::\    \                     
 *          /::::::\    \            /:::::|   |              /::::::\    \            /::::::\    \        \:::\    \            /::::::\    \            /::::::\    \            /::::::\    \        \:::\    \                    
 *         /:::/\:::\    \          /::::::|   |             /:::/\:::\    \          /:::/\:::\    \        \:::\    \          /:::/\:::\    \          /:::/\:::\    \          /:::/\:::\    \        \:::\    \                   
 *        /:::/__\:::\    \        /:::/|::|   |            /:::/__\:::\    \        /:::/__\:::\    \        \:::\    \        /:::/__\:::\    \        /:::/__\:::\    \        /:::/__\:::\    \        \:::\    \                  
 *        \:::\   \:::\    \      /:::/ |::|   |           /::::\   \:::\    \      /::::\   \:::\    \       /::::\    \      /::::\   \:::\    \      /::::\   \:::\    \      /::::\   \:::\    \       /::::\    \                 
 *      ___\:::\   \:::\    \    /:::/  |::|___|______    /::::::\   \:::\    \    /::::::\   \:::\    \     /::::::\    \    /::::::\   \:::\    \    /::::::\   \:::\    \    /::::::\   \:::\    \     /::::::\    \                
 *     /\   \:::\   \:::\    \  /:::/   |::::::::\    \  /:::/\:::\   \:::\    \  /:::/\:::\   \:::\____\   /:::/\:::\    \  /:::/\:::\   \:::\____\  /:::/\:::\   \:::\    \  /:::/\:::\   \:::\____\   /:::/\:::\    \               
 *    /::\   \:::\   \:::\____\/:::/    |:::::::::\____\/:::/  \:::\   \:::\____\/:::/  \:::\   \:::|    | /:::/  \:::\____\/:::/  \:::\   \:::|    |/:::/  \:::\   \:::\____\/:::/  \:::\   \:::|    | /:::/  \:::\____\              
 *    \:::\   \:::\   \::/    /\::/    / ~~~~~/:::/    /\::/    \:::\  /:::/    /\::/   |::::\  /:::|____|/:::/    \::/    /\::/    \:::\  /:::|____|\::/    \:::\  /:::/    /\::/   |::::\  /:::|____|/:::/    \::/    /              
 *     \:::\   \:::\   \/____/  \/____/      /:::/    /  \/____/ \:::\/:::/    /  \/____|:::::\/:::/    //:::/    / \/____/  \/_____/\:::\/:::/    /  \/____/ \:::\/:::/    /  \/____|:::::\/:::/    //:::/    / \/____/               
 *      \:::\   \:::\    \                  /:::/    /            \::::::/    /         |:::::::::/    //:::/    /                    \::::::/    /            \::::::/    /         |:::::::::/    //:::/    /                        
 *       \:::\   \:::\____\                /:::/    /              \::::/    /          |::|\::::/    //:::/    /                      \::::/    /              \::::/    /          |::|\::::/    //:::/    /                         
 *        \:::\  /:::/    /               /:::/    /               /:::/    /           |::| \::/____/ \::/    /                        \::/____/               /:::/    /           |::| \::/____/ \::/    /                          
 *         \:::\/:::/    /               /:::/    /               /:::/    /            |::|  ~|        \/____/                          ~~                    /:::/    /            |::|  ~|        \/____/                           
 *          \::::::/    /               /:::/    /               /:::/    /             |::|   |                                                              /:::/    /             |::|   |                                          
 *           \::::/    /               /:::/    /               /:::/    /              \::|   |                                                             /:::/    /              \::|   |                                          
 *            \::/    /                \::/    /                \::/    /                \:|   |                                                             \::/    /                \:|   |                                          
 *             \/____/                  \/____/                  \/____/                  \|___|                                                              \/____/                  \|___|                                          
 *                                                                                                                                                                                                                                     
 *                                                                                                                                                                                                                                     
 *                                                                                                                                                                                                                                     
 *     
 *     ________      ___    ___                                                          
 *    |\   __  \    |\  \  /  /|                                                         
 *    \ \  \|\ /_   \ \  \/  / /                                                         
 *     \ \   __  \   \ \    / /                                                          
 *      \ \  \|\  \   \/  /  /                                                           
 *       \ \_______\__/  / /                                                             
 *        \|_______|\___/ /                                                              
 *                 \|___|/                                                               
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *     ________ ________  ___  _______   ________  ________  ___  ________  ___  ___     
 *    |\  _____\\   __  \|\  \|\  ___ \ |\   ___ \|\   __  \|\  \|\   ____\|\  \|\  \    
 *    \ \  \__/\ \  \|\  \ \  \ \   __/|\ \  \_|\ \ \  \|\  \ \  \ \  \___|\ \  \\\  \   
 *     \ \   __\\ \   _  _\ \  \ \  \_|/_\ \  \ \\ \ \   _  _\ \  \ \  \    \ \   __  \  
 *      \ \  \_| \ \  \\  \\ \  \ \  \_|\ \ \  \_\\ \ \  \\  \\ \  \ \  \____\ \  \ \  \ 
 *       \ \__\   \ \__\\ _\\ \__\ \_______\ \_______\ \__\\ _\\ \__\ \_______\ \__\ \__\
 *        \|__|    \|__|\|__|\|__|\|_______|\|_______|\|__|\|__|\|__|\|_______|\|__|\|__|
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *     ________  _______       ___    ___ _______   ________                             
 *    |\   ____\|\  ___ \     |\  \  /  /|\  ___ \ |\   __  \                            
 *    \ \  \___|\ \   __/|    \ \  \/  / | \   __/|\ \  \|\  \                           
 *     \ \  \  __\ \  \_|/__   \ \    / / \ \  \_|/_\ \   _  _\                          
 *      \ \  \|\  \ \  \_|\ \   \/  /  /   \ \  \_|\ \ \  \\  \|                         
 *       \ \_______\ \_______\__/  / /      \ \_______\ \__\\ _\                         
 *        \|_______|\|_______|\___/ /        \|_______|\|__|\|__|                        
 *                           \|___|/                                                     
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *     ___       _______   ________  ________  ________  ___       ________              
 *    |\  \     |\  ___ \ |\   __  \|\   __  \|\   __  \|\  \     |\   ___ \             
 *    \ \  \    \ \   __/|\ \  \|\  \ \  \|\  \ \  \|\  \ \  \    \ \  \_|\ \            
 *     \ \  \    \ \  \_|/_\ \  \\\  \ \   ____\ \  \\\  \ \  \    \ \  \ \\ \           
 *      \ \  \____\ \  \_|\ \ \  \\\  \ \  \___|\ \  \\\  \ \  \____\ \  \_\\ \          
 *       \ \_______\ \_______\ \_______\ \__\    \ \_______\ \_______\ \_______\         
 *        \|_______|\|_______|\|_______|\|__|     \|_______|\|_______|\|_______|         
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *     ___  __    ________  ________  ___       _______   ________                       
 *    |\  \|\  \ |\   __  \|\   ____\|\  \     |\  ___ \ |\   __  \                      
 *    \ \  \/  /|\ \  \|\  \ \  \___|\ \  \    \ \   __/|\ \  \|\  \                     
 *     \ \   ___  \ \  \\\  \ \  \  __\ \  \    \ \  \_|/_\ \   _  _\                    
 *      \ \  \\ \  \ \  \\\  \ \  \|\  \ \  \____\ \  \_|\ \ \  \\  \|                   
 *       \ \__\\ \__\ \_______\ \_______\ \_______\ \_______\ \__\\ _\                   
 *        \|__| \|__|\|_______|\|_______|\|_______|\|_______|\|__|\|__|                  
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *     ________  ________  ________  _______   ________          ________  ________      
 *    |\   __  \|\   __  \|\   ____\|\  ___ \ |\   ___ \        |\   __  \|\   ___  \    
 *    \ \  \|\ /\ \  \|\  \ \  \___|\ \   __/|\ \  \_|\ \       \ \  \|\  \ \  \\ \  \   
 *     \ \   __  \ \   __  \ \_____  \ \  \_|/_\ \  \ \\ \       \ \  \\\  \ \  \\ \  \  
 *      \ \  \|\  \ \  \ \  \|____|\  \ \  \_|\ \ \  \_\\ \       \ \  \\\  \ \  \\ \  \ 
 *       \ \_______\ \__\ \__\____\_\  \ \_______\ \_______\       \ \_______\ \__\\ \__\
 *        \|_______|\|__|\|__|\_________\|_______|\|_______|        \|_______|\|__| \|__|
 *                           \|_________|                                                
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *     ________  ________  _______           ________    _____   ________                
 *    |\   __  \|\   ____\|\  ___ \         |\   __  \  / __  \ |\_____  \               
 *    \ \  \|\  \ \  \___|\ \   __/|        \ \  \|\  \|\/_|\  \ \|___/  /|              
 *     \ \  \\\  \ \  \    \ \  \_|/__       \ \  \\\  \|/ \ \  \    /  / /              
 *      \ \  \\\  \ \  \____\ \  \_|\ \       \ \  \\\  \ __\ \  \  /  / /               
 *       \ \_______\ \_______\ \_______\       \ \_______\\__\ \__\/__/ /                
 *        \|_______|\|_______|\|_______|        \|_______\|__|\|__||__|/                 
 *                                                                                       
 *                                                                                       
 *                                                                                       
 *        ___  ________  ________  _______                                               
 *       |\  \|\   ____\|\   __  \|\  ___ \                                              
 *       \ \  \ \  \___|\ \  \|\  \ \   __/|                                             
 *     __ \ \  \ \  \    \ \   __  \ \  \_|/__                                           
 *    |\  \\_\  \ \  \____\ \  \ \  \ \  \_|\ \                                          
 *    \ \________\ \_______\ \__\ \__\ \_______\                                         
 *     \|________|\|_______|\|__|\|__|\|_______|                                         
 *                                                                                       
 *    2016
 */
package at.smartpart.listeners;

import java.awt.Dimension;
import java.awt.Font;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import javax.swing.AbstractButton;
import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTree;
import javax.swing.SwingUtilities;
import javax.swing.event.TableModelEvent;
import javax.swing.event.TableModelListener;
import javax.swing.table.AbstractTableModel;
import javax.swing.table.DefaultTableModel;
import javax.swing.tree.DefaultMutableTreeNode;
import org.apache.commons.collections4.ListUtils;
import com.ptc.cipjava.jxthrowable;
import com.ptc.pfc.pfcCommand.DefaultUICommandActionListener;
import com.ptc.pfc.pfcModel.Model;
import com.ptc.pfc.pfcModel.ModelType;
import com.ptc.pfc.pfcSession.Session;

import at.smartpart.Workbench;
import at.smartpart.beans.CadPart;
import at.smartpart.beans.VersionComparator;
import at.smartpart.resolve.MyTreeTraversal;
import at.smartpart.resolve.SubTreeTraversal;
import at.smartpart.transfer.FetchVersionString;
import at.smartpart.transfer.UploadData;

public class UploadListener extends DefaultUICommandActionListener {

	public static final boolean DEBUG = false;
	private Session session = null;
	private List<CadPart> cleanedUlList = new ArrayList<CadPart>();
	private static List<String> toUpload = new ArrayList<String>();
	private Object[][] data = new Object[2][2];
	private String[] colums = { "Filename", "local Version", "current Version", "new Version", "checkin" };
	private MyTableModel tModel;
	protected JFrame membersDialog = new JFrame();
	private JPanel panel = new JPanel();
	private JTable table = new JTable();
	private boolean firstRun = true;
	private JButton btnConfirm;
	private List<CadPart> curVersionsTable;
	private List<CadPart> drwNodes = new ArrayList<CadPart>();
	Font font;
	CadPart drawing;
	private List<CadPart> dummyListDrw = new ArrayList<CadPart>();

	public UploadListener(Session wfSession) {
		this.session = wfSession;
	}

	@Override
	public void OnCommand() throws jxthrowable {

		Model model = session.GetCurrentModel();

		if (model != null) {

			// USE PTC default font for our App

			com.ptc.pfc.pfcDisplay.Font ptcFont = session.GetDefaultFont();
			String defFontName = ptcFont.GetName();
			font = new Font(defFontName, Font.PLAIN, 30);

			List<CadPart> uploadList = new ArrayList<CadPart>();
			Map<String, DefaultMutableTreeNode> knots = new LinkedHashMap<String, DefaultMutableTreeNode>();
			Map<String, JTree> subAsms = new HashMap<String, JTree>();
			// GENERATE CHECKIN META FOR ASSEMBLY

			if (model.GetType() == ModelType.MDL_ASSEMBLY) {
				MyTreeTraversal traverse = new MyTreeTraversal(model, session);

				// Get List of objects for db from Session --> these objects
				// will be uploaded (plain List)

				uploadList = traverse.getPRTList();
				knots = traverse.getResultMap();
				// traverse.createBom();

				SubTreeTraversal subTrav = new SubTreeTraversal(session, knots);
				subAsms = subTrav.getResultMap();

			}

			// GENERATE CHECKIN META FOR DRW

			if (model.GetType() == ModelType.MDL_DRAWING) {
				MyTreeTraversal traverse = new MyTreeTraversal(session);
				traverse.getDRWMembers(model);
				drwNodes = traverse.getDrwNodes();

				// Get List of objects for db from Session --> these objects
				// will be uploaded (plain List)

				uploadList = new ArrayList<CadPart>();
				uploadList = traverse.getPRTList();
				uploadList.add(new CadPart(model.GetFileName(), -2));

			}

			// GENERATE CHECKIN META FOR PRT

			if (model.GetType() == ModelType.MDL_PART) {
				uploadList.add(new CadPart(model.GetFileName(), -2));
			}

			StringBuilder sb = new StringBuilder();
			sb.append("Upload these Candidates :  \n");

			toUpload.clear();
			cleanedUlList.clear();

			for (int i = 0; i < uploadList.size(); i++) {

				String prt = uploadList.get(i).getFileName();
				String asm = uploadList.get(i).getFileName();
				String drw = uploadList.get(i).getFileName();

				if (!toUpload.contains(drw)) {
					toUpload.add(drw);
					cleanedUlList.add(uploadList.get(i));
				} else if (!toUpload.contains(asm)) {
					toUpload.add(asm);
					cleanedUlList.add(uploadList.get(i));
				} else if (!toUpload.contains(prt)) {
					toUpload.add(prt);
					cleanedUlList.add(uploadList.get(i));
				}

			}

			for (int i = 0; i < toUpload.size(); i++) {
				sb.append("#:" + i + toUpload.get(i) + "\n");
			}

			FetchVersionString fetchVersion = new FetchVersionString();
			List<CadPart> curVersions = fetchVersion.fetch(toUpload);

			List<CadPart> notFoundInDB = ListUtils.subtract(cleanedUlList, curVersions);

			for (int i = 0; i < notFoundInDB.size(); i++) {
				notFoundInDB.get(i).setCurVersion(-1);
				notFoundInDB.get(i).setNextVersion(0);
			}
			// Zusammensetzten der Listen :

			curVersionsTable = new ArrayList<CadPart>();

			curVersionsTable.addAll(notFoundInDB);
			curVersionsTable.addAll(curVersions);

			Collections.sort(curVersionsTable, new VersionComparator());

			final Map<String, CadPart> map = new LinkedHashMap<String, CadPart>();
			int k = 0;

			for (CadPart cadPart : curVersionsTable) {
				System.out.println("" + k);
				map.put(cadPart.getFileName(), cadPart);
				k++;
			}
			curVersionsTable.clear();
			curVersionsTable.addAll(map.values());

			Collections.sort(curVersionsTable, new VersionComparator());

			System.out.println(data.toString());

			Workbench.setWorkDir(session.GetCurrentDirectory());

			/*
			 * Runnable edt = new Runnable() { public void run() {
			 * 
			 * 
			 * createBaseWindow(subAsms, map);
			 * 
			 * } }; SwingUtilities.invokeLater(edt);
			 */

			createBaseWindow(subAsms, map);

		}

		else

		{
			System.out.println("No solid in session");
		}

	}

	private void createBaseWindow(Map<String, JTree> subAsms, Map<String, CadPart> myMap) {

		panel.removeAll();

		data = new Object[curVersionsTable.size()][2];

		Dimension dim = new Dimension(1000, 600);

		for (int i = 0; i < curVersionsTable.size(); i++) {

			CadPart cadPart = curVersionsTable.get(i);

			System.out.println("in loop " + i + " " + cadPart.getFileName());

			Object[] rowData = { cadPart.getFileName(), cadPart.getLocalVersion(), cadPart.getCurDbVersion(),
					cadPart.getNextVersion(), new Boolean(false) };

			data[i] = rowData;

		}

		if (firstRun) {
			tModel = new MyTableModel(data, colums);
			table = new JTable(tModel);
		}
		if (!firstRun) {
			MyTableModel model2 = (MyTableModel) table.getModel();
			model2.setDataVector(data, colums);
			table = new JTable(model2);
		}

		firstRun = false;

		tModel.fireTableDataChanged();

	/*	table.getModel().addTableModelListener(new TableModelListener() {
			public void tableChanged(TableModelEvent evt) {
				String fileName = "";

				for (int i = 0; i < table.getModel().getRowCount(); i++) {
					if ((Boolean) table.getModel().getValueAt(i, 4)) {

						// System.out.println(">\t" + table.getSelectedRow());
						int row = table.getSelectedRow();
						fileName = table.getModel().getValueAt(row, 0).toString();

						// System.out.println(">\fn " + fileName);
						myMap.get(fileName).setUpload(table.getModel().getValueAt(row, 4).toString());
						// break;
					} else {
						if (myMap.containsKey(fileName)) {
							myMap.remove(fileName);
						}
					}
				}
			}
		});
*/
		table.setFont(font);
		table.setRowHeight(font.getSize() + 10);

		table.setAutoCreateColumnsFromModel(true);
		// table.tableChanged(null);

		JScrollPane jsp = new JScrollPane(table);
		table.invalidate();
		table.setSize(dim);
		table.repaint();
		jsp.invalidate();
		jsp.repaint();

		btnConfirm = new JButton("Check In");
		btnConfirm.addActionListener(new ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent e) {

				Runnable edt = new Runnable() {
					public void run() {

						for (CadPart prt : drwNodes) {

							String prtFileName = prt.getFileName();
							String cadPrtFileName = "";
							for (CadPart cadPart : curVersionsTable) {
								
								cadPrtFileName = cadPart.getFileName();
								
								if (prtFileName.toLowerCase().equals(cadPrtFileName.toLowerCase())) {
									
									int curVersion = cadPart.getCurDbVersion();
									int nextVersion = cadPart.getNextVersion();
									
									System.out.println("curVersion:" + curVersion);
									System.out.println("nextVersion:" + nextVersion);
									
									prt.setCurVersion(curVersion);
									prt.setNextVersion(nextVersion);
								}
							}
							System.out.println("drwNodes : " + prt.getFileName() + " " + prt.getCurDbVersion() + " " + prt.getNextVersion());
						}

						Map<String, CadPart> mMap = new LinkedHashMap<String, CadPart>();
						int y = 0;
						for (CadPart cadPart : curVersionsTable) {

							// boolean upload = (Boolean)
							// table.getModel().getValueAt(y,4);

							System.out.println("try to upload " + cadPart.getFileName() + "   " + cadPart.getUpload());

							cadPart.setUpload(table.getModel().getValueAt(y, 4).toString());
							mMap.put(cadPart.getFileName(), cadPart);
						}

						UploadData ul = new UploadData();
						ul.setDrwNodes(drwNodes);
						ul.send(subAsms, mMap);

						try {
							fadeOut();
						} catch (jxthrowable ex) {

							ex.printStackTrace();
							System.out.println(ex.toString());
						}

						curVersionsTable.clear();

					}

				};
				SwingUtilities.invokeLater(edt);

			}
		});

		jsp.setVisible(true);
		jsp.repaint();
		jsp.invalidate();
		panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));
		JPanel hpanel = new JPanel();
		hpanel.setLayout(new BoxLayout(hpanel, BoxLayout.X_AXIS));
		hpanel.repaint();
		panel.add(jsp);// , BorderLayout.CENTER);
		panel.add(hpanel);
		panel.repaint();
		table.setVisible(true);
		hpanel.add(btnConfirm);
		panel.setSize(990, 590);
		panel.setVisible(true);
		membersDialog.getContentPane().add(panel);
		membersDialog.repaint();
		membersDialog.setSize(dim);
		membersDialog.setAlwaysOnTop(true);
		membersDialog.setVisible(true);

	}

	public List<CadPart> getDrwNodes() {
		return drwNodes;
	}

	public static List<String> getList() {
		return toUpload;
	}

	void fadeOut() throws jxthrowable {

		Runnable edt = new Runnable() {
			public void run() {
				membersDialog.setVisible(false);

				clearArray(data);

				membersDialog.removeAll();

				// membersDialog.repaint();

			}
		};
		SwingUtilities.invokeLater(edt);

	}

	private void clearArray(Object[][] data2) {

		for (int i = 0; i < data2.length; i++) {
			for (int j = 0; j < data2.length; j++) {
				data2[i][j] = "";
			}
		}

	}

	class MyTableModel extends AbstractTableModel {
		private String[] columns;

		private Object[][] data; /*
									 * = { { "Mary", "Campione", "Snowboarding",
									 * new Integer(5), new Boolean(false) }, {
									 * "Alison", "Huml", "Rowing", new
									 * Integer(3), new Boolean(true) }, {
									 * "Kathy", "Walrath", "Knitting", new
									 * Integer(2), new Boolean(false) }, {
									 * "Sharon", "Zakhour", "Speed reading", new
									 * Integer(20), new Boolean(true) }, {
									 * "Philip", "Milne", "Pool", new
									 * Integer(10), new Boolean(false) } };
									 */

		public MyTableModel(Object[][] data, String[] columns) {
			this.data = data;
			this.columns = columns;
		}

		public void setDataVector(Object[][] data2, String[] colums) {
			this.data = data2;
			this.columns = colums;

		}

		public int getColumnCount() {
			return columns.length;
		}

		public int getRowCount() {
			return data.length;
		}

		public String getColumnName(int col) {
			return columns[col];
		}

		public Object getValueAt(int row, int col) {

			return data[row][col];

		}

		/*
		 * JTable uses this method to determine the default renderer/ editor for
		 * each cell. If we didn't implement this method, then the last column
		 * would contain text ("true"/"false"), rather than a check box.
		 */
		public Class getColumnClass(int c) {
			return getValueAt(0, c).getClass();
		}

		/*
		 * Don't need to implement this method unless your table's editable.
		 */
		public boolean isCellEditable(int row, int col) {
			// Note that the data/cell address is constant,
			// no matter where the cell appears onscreen.
			if (col < 2) {
				return false;
			} else {
				return true;
			}
		}

		/*
		 * Don't need to implement this method unless your table's data can
		 * change.
		 */
		public void setValueAt(Object value, int row, int col) {
			if (DEBUG) {
				System.out.println("Setting value at " + row + "," + col + " to " + value + " (an instance of "
						+ value.getClass() + ")");
			}

			data[row][col] = value;
			fireTableCellUpdated(row, col);
			// fireTableDataChanged();
			if (DEBUG) {
				System.out.println("New value of data:");
				printDebugData();
			}
		}

		private void printDebugData() {
			int numRows = getRowCount();
			int numCols = getColumnCount();

			for (int i = 0; i < numRows; i++) {
				System.out.print("    row " + i + ":");
				for (int j = 0; j < numCols; j++) {
					System.out.print("  " + data[i][j]);
				}
				System.out.println();
			}
			System.out.println("--------------------------");
		}
	}

}